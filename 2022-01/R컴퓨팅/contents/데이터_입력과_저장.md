# 데이터 입력과 저장

## 학습목표

1. 데이터 입력에 대해서 알아볼 수 있다.
2. 분석한 결과를 외부 파일로 저장하는 법에 대해서 설명할 수 있다.
3. 새롭게 만든 테이블을 외부 CSV 파일로 저장하는 법에 대해서 설명할 수 있다.

## 주요용어

- 데이터 입력 : R에서 각종 연산 및 명령 수행의 대상이 되는 데이터가 인식되도록 하는 과정
- 외부파일 : R에 내장되어 있지 않고 로컬 디스크 등에 별도로 저장된 파일
- 데이터 저장 : R에서 명령을 수행한 뒤 처리된 결과를 데이터 형태로 저장하는 과정

## 강의 정리 & 필기

### 1. 데이터의 입력

#### 1) 작업 directory 설정 및 현재 directory 확인
  - R을 활용할 때 작업 디렉토리 변경의 필요성이 있음
    - 기본 작업경로가 길고 복잡한 경우에는 경로를 일일이 찾아 지정하는 것이 매우 번거로울 수 있으므로 작업디렉토리를 변경
      - 예를 들어 D 드라이브 하에 "datav"라는 directory가 만들어져 잇다고 가정할 경우, 아래와 같은 명령으로 작업 디렉토리를 설정 및 향후 접근 가능
        ```R
          setwd('D:\\datav') # set working directory
        ```
      - 현 작업 디렉토리 확인은 `getwd()`함수를 이용
      - 미리 생성해 둔 폴더만을 지정할 수 있음.
#### 2) c() 함수를 이용한 입력
  - 좌측에 벡터 이름(객체명)이 위치하여 `<-` 나 `=` 연산자는 데이터가 할당됨을 의미하고 우측에는 입력대상이 되는 데이터의 관측값이 c 함수 내에 나타나게 됨
  ```R
  ### 두 개의 벡터 x와 y를 결합하여 dat라는 객체 object를 생성.
    x <- c(1, 2, 3, 4, 5)
    y <- c(10, 20, 30, 40, 50)
    dat <- cbind(x, y)
    dat
  ```
#### 3) scan 함수를 이용한 데이터 입력
   - 함수를 실행하면 실행프롬프트가 "1:"로 바뀌게 되는데, 이때 자료를 하나씩 입력
   - 공백일 때 Enter를 치면 입력 종료.
   - 입력 받은 데이터를 벡터로 받음.

#### 4) edit() 함수를 이용한 입력
   - edit()함수를 이용하여 데이터프레임을 생성하기 위해 빈 객체를 데이터프레임으로 지정해 준 뒤 창을 열어 데이터를 입력
    ```R
      df <- data.frame()
      df = edit(df)
    ```

### 2. 데이터 저장
: 데이터 출력

#### 1) sink() 함수를 출력결과 파일 저장
- 함수 `sink()`를 활용하여 화면에 출력된 모든 결과를 파일로 저장
  - 시작 시 저장할 파일명을 지정하고 원하는 함수를 실행시킨 뒤 종료시 `sink()`로 마감
    ```R
      rm(list = ls()) # R studio 의 global enviroment를 모두 날림.
      sink('test.txt')
      summary(iris)
      sink()
    ```
  - 현 작업 디렉토리에 저장된 `test.txt`라는 파일을 열면, 아래와 같이 기술통계량이 저장되어 있음.

#### 2) write.csv() 함수를 이용한 데이터 저장
  - R에서 생성된 객체(object)는 외부 파일로 저장할 수 있음
  - 다른 경로가 지정되어 있지 않다면 이 파일은 기 설정된 작업 directory에 저장.
    ```R
      df <- data.frame()
      df <- edit(df)
      write.csv(df, 'write_csv.csv')
    ```

#### 3) write.table() 함수를 이용한 데이터 저장
  - `write.table()`함수도 R의 객체를 외부로 저장한다는 점에서는 `write.csv()`와 유사하지만, 기본적으로 지정되어 있는 옵션 상 차이가 있다.

### 3. 데이터 불러오기

#### 1) read.csv() 함수를 이용한 데이터 불러오기
  - 작업 디렉토리에 있는 csv 파일을 읽어 출력해보기
    ```R
      csvDf <- read.csv('write_csv.csv')
      csvDf
    ```
  - header가 있는 파일의 경우 아래와 같이 호출하면 `head()` 함수에서 header값을 볼 수 있음.
    ```R
      csvHead <- read.csv('write_csv.csv', header = T)
      head(csvHead)
    ```

#### 2) str() 함수를 이용하여 데이터 구조 확인하기
  - R에서 불러온 자료구조를 확ㅇ니하기 위해서는 `str()` 함수를 사용
  - read.csv() 함수를 이용하여 USArrestd.csv 데이터 셋을 불러오되, `stringAsFactors=F` 라는 옵션을 이용하여 문자 변수가 Factor 변수로 인식되지 않도록 지정.
    ```R
      us_dat2 <- read.csv('USArrestd.csv', header=T, stringAsFactors=F)
      str(us_dat2)
    ```

#### 3) read.table() 함수를 이용한 데이터 불러오기
  - 텍스트 파일은 read.csv() 함수 외에도 read.table() 함수를 이용하여 불러올 수 있음
  - 현 작업경로에 저장되어 있는 dat_exam2.txt라는 파일을 read.table() 함수를 이용하여 불러오기

#### 4) na.strings 옵션을 이용한 결측치 지정
  - R에서는 결측치가 `NA`로 표시되지만 데이터를 읽어오면서 na.strings와 같은 옵션을 지정해주면 특정한 문자를 결측치로 인식
  - 관측값 `aa`를 결측치로 인식하여 데이터 불러오기
    ```R
      test <- read.table('test.txt', na.strings='aa', header=T)
    ```

### 4. 객체(object) 확인 및 삭제

#### 1) ls() 함수를 이용한 객체 확인
   - `ls()` 함수를 이용하면 현재까지의 작업 중 만들어진 object를 모두 확인할 수 있음.
   - `rm()` 함수를 수행하면 생성된 모든 object를 삭제할 수 있음
      ```R
        rm(list = ls())
      ```

## 정리하기

1. 키보드를 이용하여 데이터를 입력하는 방식은 c() 함수, scan() 함수, edit() 함수 등이 있다.
2. 외부파일을 읽어서 R로 불러들이는 방식으로는 read.table(), read.csv(), scan() 함수 등이 있다.
3. 웹사이트에 위치해 있는 외부파일의 데이터도 read.table() 명령문에 의해서 R에서 불러 읽을 수 있다.
4. sink() 함수는 명령문 결과를 R에서 출력되는 형태대로 파일로 저장하는 명령문이고, cat() 함수는 명령문 결과를 파일에 저장하되 줄 단위로 저장하는 명령문이다.
5. R에서 생성된 데이터프레임을 외부 파일로 저장하는 방식은 write.table(), write.csv() 등의 함수가 있다.