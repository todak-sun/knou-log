# 확률분포

## 학습목표

1. 이항분포를 이해하고, 활용할 수 있다.
2. 초기하분포를 이해하고, 활용할 수 있다.
3. 포아송분포를 이해하고, 활용할 수 있다.
4. 정규분포를 이해하고, 활용할 수 있다.

## 강의 정리 & 필기

### 1.이산형 확률분포

#### 이항분포 적용 사례
- 동전을 5번 던질 때 앞면의 수
- 공장에서 생산된 제품 100개를 검사할 때 발견되는 불량품의 수
- 유권자 50명 중 특정 후보를 지지하는 사람 수

실험(조사)의 결과가 어떻게 될지 사전에 알 수 없지만 모든 가능한 결과가 두 가지({앞, 뒤}, {불량, 양호}, {찬성, 반대})이고 반복됨.

#### 베르누이 시행, 시행, 독립시행

베르누이 시행
- 각 실험의 결과가 두 가지만 가능한 시행
- 예: 앞면과 뒷면, 성공과 실패, 합격과 불합격

베르누이시행의 예
- 제품 검사로 불량품과 양호품으로 구분하는 경우
- 유권자에게 특정 후보에 대한 지지 여부를 묻는 경우

시행
- 같은 실험을 반복할 때 각각의 실험

독립시행
- 각 시행의 결과들이 서로 독립인 경우

#### 이항분포(binomial distribution)
- 각 시행에서 성공률이 $p$인 베르누이시행을 $n$번 독립시행
- $X = \text{"n번의 베르누이 독립시행에서 얻은 총 성공 횟수"}$

$ X \sim B(n, p) $
$ P(X = x) = {n \choose x}p^{x}(1 - p)^{n-x}, x = 0, 1, 2, \cdots, n$
$ E(X) = np, Var(X) = np(1 - p)$

- 각 시행의 성공률 $p$와 시행횟수 $n$에 따라 이항확률변수 $X$의 확률분포가 결정됨

#### 이항분포 사례
- 공정한 동전을 5번 던지는 실험
  - $X = \text{5번 던져서 나온 앞면의 수}$
  - $n = 5, p = 0.5$
  - $X \sim B(5, 0.5)$
  - $P(X = 0) = {5 \choose 0}(\frac{1}{2})^{0}(\frac{1}{2})^{5} = \frac{1}{32}$

```R
dbinom(0, 5, 0.5)
```

#### 이항분포 확률계산1
어느 보험회사의 영업사원이 한 고객을 만날 때 그 사람이 보험에 가입하게 될 확률은 경험으로 볼때 20%이다. 오늘 이 영업사원이 고객 10명을 만날 예정이다.
$p = 0.2, n = 10, X \sim B(10, 0.2)$
- 세 명이 보험에 가입할 확률은?
$_{10}C_{3} \times (0.2)^{3} \times (0.8)^{7}$
    ```R
    dbinom(3, 10, 0.2)
    ```
- 두 사람 이상이 보험에 가입할 확률은?
$1 - P(X \le 1)$
    ```R
    1 - pbinom(1, 10, 0.2)
    ```
- 10명 중 보험에 가입한 사람의 평균과 분산은?
$
E(X) = np = 2 \\ 
Var(X) = np(1 - p) = 2 \times 0.8 = 1.6
$ 

#### 이항분포 확률계산2
당첨률이 30%인 복권을 8장 구입했다고 한다.
$p = 0.3, n = 8, X \sim B(8, 0.3)$

- 4장이 당첨될 확률은?
$_{8}C_{4} \times (0.3)^{4} \times (0.7)^{4}$
- 3장에서 7장이 당첨될 확률은?
$P(X \le 7) - P(X \le 2)$
  ```R
    pbinom(7, 8, 0.3) - pbinom(2, 8, 0.3)
  ```
- 6장 이상이 당첨될 확률은?
$P(X \ge 6) = 1 - P(X \le 5)$

#### 초기하분포
- 전체 $N$개인 모집단이 '1' 또는 '0', '성공' 또는 '실패' 등으로 두 가지로 분류
- 확률변수 $X$ = "전체 $N$개 중 1이 D개, 0이 $N - D$개로 구성된 구성된 유한 모집단에서 크기 $n$인 랜덤표본을 뽑을 때 1이 나오는 수"

#### 초기하분포 예제
흰 공 3개와 검은 공 2개가 들어있는 주머니에서 임의로 2개를 꺼냈을 때 X를 검은 공의 개수인 확률변수로 정의하자. $P(X = 0)$과 $P(X = 2)$를 구하시오

$P(X = 0) = \frac{_{2}C_{0} \cdot _{3}C_{2}}{_{5}C_{2}} = \frac{3}{10}$
$P(X = 2) = \frac{_{2}C_{2} \cdot _{3}C_{0}}{_{5}C_{2}} = \frac{1}{10}$

#### 초기하분포의 평균과 분산

- $X$ = "전체 $N$개 중 1이 $D$개, 0이 $N-D$개로 구성된 유한모집단에서 크기 $n$인 랜덤표본을 뽑을 때 1이 나오는 수"
- 평균: $E(X) = np$, 단 $p = \frac{D}{N}$
- 분산: $Var(X) = np(1 - p) \cdot \frac{N-n}{N-1}$

#### 포아송(Poisson) 분포 적용 예
발생 확률이 아주 작은 희귀한 사건의 수에 대한 확률분포에 이용
- 고속도로 상에서 하루동안 발생하는 교통사고에 의한 사망자 수
- 어느 집에 한 시간 동안에 걸려오는 전화통화 수
- 야구 경기 한 게임에서 나오는 홈런 수
- 1주일간 어떤 동사무에서 접수되는 사망신고 수

#### 포아송분포를 적용하기 위한 가정

- 독립성
  - 서로 다른 단위에서 출현하는 횟수는 서로 독립
  - 예: 시간대별로 걸려오는 전화의 수는 연관성이 없음.
- 비집락성
  - 극히 작은 단위에서 둘 이상이 일어날 확률은 매우 작음
- 비례성
  - 단위시간이나 공간에서 성공의 평균 출현횟수는 일정함
  - 예: 시간대를 늘리면, 전화의 수도 비례해서 늘어남

#### 포아송분포(Poisson distribution)
단위당 평균 발생률이 $m$인 어떤 현상에 대해서
- $X$ = 단위당 발생횟수
- $X \sim Poisson(m)$
- $P[X = x] = \frac{e^{-m}m^{x}}{x!}, x = 0, 1, 2, \cdots, e = 2.718281$
- $E(X) = m, Var(X) = m$

#### 포아송분포 사례
은행에서 하루 평균 6건의 불량수표를 받게 된다고 할 때, 어떤 특정한 날에 불량수표를 4번 받을 확률은?
$m = 6, x = 4$
$P(X=4) = \frac{6^{4}e^{-6}}{4!} = 0.134$

### 2.연속형 확률분포

#### 확률밀도함수 $f(x)$의 성질
- $f(x) \ge 0$
- $\int_{-\infty}^{\infty}f(x) = 1$
- $p(a < X \le b) = \int_{a}^{b}f(x)dx$

#### 정규분포(Normal distribution)
확률변수 $X$는 평균 $\mu$, 표준편차 $\sigma$인 정규분포를 따른다.
$X \sim N(\mu, \sigma^{2})$
$f(x) = \frac{1}{\sqrt{2\pi}\sigma}exp[-\frac{(x - \mu)^{2}}{2\sigma^{2}}]$, $-\infty < x < \infty$

- $\mu$와 $\sigma$의 값에 의해서 정규분포 결정
  - 종 모양이고, 평균 $\mu$에 관해 서로 대칭
  - 드 므와브르(A. de Moivre(1667 - 1754)), 가우스(C.F.Gauss(1777-1855))

#### 정규분포에서 확률 $P(a \le X \le b)$
$P(a \le X \le b) = \int_{a}^{b}\frac{1}{\sqrt{2\pi}\sigma}exp[-\frac{(x - \mu)^{2}}{2\sigma^{2}}]dx$

#### 정규분포의 표준화
- $X \sim N(\mu, \sigma^{2})$이면 $Z = \frac{X - \mu}{\sigma} \sim N(0, 1)$
- $X$가 평균이 $\mu$, 분산이 $\sigma^{2}$인 정규분포를 따를 때
  - $P(X < x) = P(\frac{X - \mu}{\sigma} < \frac{x - \mu}{\sigma}) = P(Z < \frac{x - \mu}{\sigma})$
  - $P(a < X < b) = P(\frac{a - \mu}{\sigma} < Z < \frac{b - \mu}{\sigma})$

#### 정규분포 확률 계산1
확률변수 $X$ 가 평균이 70, 표준편차가 10인 정규분포를 따를 때
$X \sim N(70, 10^{2})$
1. P(X < 94.3)
   $P(X < 94.3) = P(\frac{X - 70}{10} < \frac{94.3 - 70}{10}) = P(Z < 2.43) = 0.9925$
2. P(X > 57.7)
   $P(X > 57.7) = P(\frac{X - 70}{10} > \frac{57.7 - 70}{10}) = P(Z < -1.23) = 0.8907$

#### 정규분포 확률 계산2
집에서 회사까지 통근 시간 X(분)은 정규분포 $N \sim (40, 5^{2})$를 따름
통근 시간이 50분 이상 걸릴 확률은?
$1 - P(X < 50) = 1 - P(Z < \frac{50 - 40}{5}) = 1 - P(Z < 2)$